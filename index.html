<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="content-language" content="en-us">
    <title>Elevator</title>
    <meta name="author" content="Matheus Avellar">
    <script src="./resources/jquery.js" type="text/javascript"></script>
    <link rel="shortcut icon" href="./resources/favicon.png" type="image/png">
    <link rel="icon" href="./resources/favicon.png" type="image/png">
    <style type="text/css">
        @font-face {
            font-family: "Meyrin";
            src: local("Meyrin"), url(./resources/Meyrin.woff) format("woff");
            src: local("Meyrin"), url(./resources/Meyrin.ttf) format("truetype");
        }
        body {
            background-color: #555;
            color: #0e0e0e;
            margin: 0;
            overflow: hidden;
            text-align: center;
            font-family: "Courier New", monospace;
            font-size: 55px;
        }
        #current {
            color: #e74c3c;
            font-family: "Meyrin", monospace;
            background: #0e0e0e;
            border: 1px solid #898989;
            padding: 10px 20px;
        }
        #t {
            padding-top: 15px;
        }
        #c {
            top: 0;
            left: 0;
            /*border: 1px solid #ecf0f1;*/
            cursor: default;
        }
    </style>
</head>
<body onload="$gc.init();">
    <div id="main">
        <center>
            <div id="t"><a id="ardw">\/</a>&nbsp;<a id="current">0</a>&nbsp;<a id="arup">/\</a></div>
            <canvas id="c" width="500" height="500"></canvas>
        </center>
    </div>
    <script type="text/javascript">

        "use strict";

        const C = document.getElementById("c");
        const CTX = c.getContext("2d");
        const h50 = (C.height / 2);
        const w50 = (C.width / 2);

    /*(function() {*/

        var $gc = {
            init: function() {
                $gc.update();
            },
            c: {
                GREEN: "#33ce75",
                RED: "#e74c3c",
                WHITE: "#ecf0f1",
                GREY: "#444",
                BLACK: "#0e0e0e"
            },
            draw: {
                rect: function(x, y, w, h, c) {
                    CTX.fillStyle = (typeof c == "string") ? c : "#000";
                    CTX.fillRect(x, y, w, h);
                },
                text: function(t, x, y, f, c) {
                    CTX.fillStyle = (typeof c == "string") ? c : "#000";
                    CTX.font = f;
                    CTX.fillText(t, x, y);
                },
                foo: function() {
                    CTX.clearRect(0, 0, C.width, C.height);
                    if ($gc.scene == 0) {
                        $gc.draw.rect(51, 76, 20, 20, $gc.c.BLACK);
                        $gc.draw.rect(50, 75, 20, 20, $gc.c.GREY);
                        $gc.draw.text(1, 55, 93, "20px 'Meyrin'", $gc.c.RED);
                        $gc.draw.text("Play", 80, 95, "30px 'Courier New'", $gc.c.BLACK);

                        $gc.draw.rect(51, 101, 20, 20, $gc.c.BLACK);
                        $gc.draw.rect(50, 100, 20, 20, $gc.c.GREY);
                        $gc.draw.text(1, 55, 93, "20px 'Meyrin'", $gc.c.RED);
                        $gc.draw.text("Credits", 80, 125, "30px 'Courier New'", $gc.c.BLACK);
                    } else if ($gc.scene == 1) {
                        for (let _i = 0, _l = $gc.floor.available.length; _i < _l; _i++) {
                            if (!$gc.floor.available[_i].p) {
                                $gc.draw.rect(51, _i * 25 + 51, 20, 20, $gc.c.BLACK);
                                $gc.draw.rect(50, _i * 25 + 50, 20, 20, $gc.c.GREY);
                                $gc.draw.text($gc.floor.available[_i].n, 55, _i * 25 + 68, "20px 'Meyrin'", $gc.c.RED);
                            } else {
                                $gc.draw.rect(51, _i * 25 + 51, 20, 20, $gc.c.GREEN);
                                $gc.draw.rect(50, _i * 25 + 50, 20, 20, $gc.c.GREY);
                                $gc.draw.text($gc.floor.available[_i].n, 55, _i * 25 + 68, "20px 'Meyrin'", $gc.c.GREEN);
                            }
                        }
                    }
                }
            },
            update: function() {
                $gc.draw.foo();

                if ($gc.scene == 0) {
                } else if ($gc.scene == 1) {
                    let _a = $gc.floor.available;
                    if ($gc.floor.destination > _a[_a.length - 1].n
                     || $gc.floor.destination < _a[0].n) {
                        $gc.floor.destination = _a[0].n;
                    }

                    $gc.draw.text($gc.floor.destination, 100, 100, "50px 'Meyrin'", $gc.c.RED);
                    if ($gc.isMoving) {
                        console.log($gc.timeElapsed);
                        if ($gc.direction && $gc.timeElapsed != 0) {
                            $("#arup").css({color: $gc.c.GREEN});
                            $("#ardw").css({color: $gc.c.BLACK});
                        } else if (!$gc.direction && $gc.timeElapsed != 0){
                            $("#arup").css({color: $gc.c.BLACK});
                            $("#ardw").css({color: $gc.c.GREEN});
                        }
                        $gc.isMoving = ($gc.floor.destination != $gc.floor.current);
                        if ($gc.timeElapsed == $gc.elevatorSpeed) {
                            $gc.timeElapsed = 0;
                            $gc.direction = ($gc.floor.current < $gc.floor.destination ? !0 : !1);
                            $gc.floor.current += ($gc.floor.current < $gc.floor.destination ? 1 : -1);
                            $("#current").text($gc.floor.current);
                        }
                        $gc.timeElapsed++;
                    } else if ($gc.floor.current == $gc.floor.destination) {
                        $gc.floor.available[$gc.floor.current].p = !1;
                    }
                    if (!$gc.isMoving) {
                        $("#arup").css({color: $gc.c.BLACK});
                        $("#ardw").css({color: $gc.c.BLACK});
                    }
                } else if ($gc.scene == 2) {

                } else {

                }

                let _t = setTimeout($gc.update, 30);
            },
            scene: 0, // 0: Menu, 1: Game, 2: Credits
            floor: {
                current: 0,
                available: [
                    {  n: 0, p: !1  },
                    {  n: 1, p: !1  },
                    {  n: 2, p: !0  },
                    {  n: 3, p: !0  },
                    {  n: 4, p: !0  },
                    {  n: 5, p: !1  },
                    {  n: 6, p: !0  },
                    {  n: 7, p: !1  }
                ],
                queue: [4, 6, 3, 2],
                destination: 4
            },
            timeElapsed: 0,
            level: 1,
            isMoving: !0,
            elevatorSpeed: 50,
            direction: !1,
            people: {
                list: [
                    {  f: 1, p: 100, d: 2  },
                    {  f: 4, p: 100, d: 1  }
                ],
                ctrl: function() {

                }
            }
        };

    /*})();*/
    </script>
</body>
</html>
